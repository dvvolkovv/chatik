# –£–ª—É—á—à–µ–Ω–∏—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –≤ AI Chat Platform

## –î–∞—Ç–∞: 2 —Ñ–µ–≤—Ä–∞–ª—è 2026

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ë—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–π –∏ –ø–ª–∞–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —á–∞—Ç–∞ —Å AI.

---

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ backend (–ö–†–ò–¢–ò–ß–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–∫–µ–Ω—ã —Å—á–∏—Ç–∞–ª–∏—Å—å –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ (`total_tokens_output += 1`) –∏ –±—Ä–∞–ª–∏—Å—å –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —á–∞–Ω–∫–∞, —á—Ç–æ –¥–∞–≤–∞–ª–æ –Ω–µ—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `stream_options={"include_usage": True}` –≤ OpenRouter API –∑–∞–ø—Ä–æ—Å
- –§–∏–Ω–∞–ª—å–Ω—ã–π —á–∞–Ω–∫ —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–∫–µ–Ω–∞—Ö –∏–∑ API
- –ù–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –≤–æ –≤—Ä–µ–º—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —á–∞–Ω–∫ —Å —Ç–æ—á–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

**–§–∞–π–ª—ã:**
- `app/services/llm_service.py` - –º–µ—Ç–æ–¥ `_stream_openrouter()`
- `app/api/llm.py` - —Ñ—É–Ω–∫—Ü–∏—è `event_stream()`

**–ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```python
# –í llm_service.py
stream_options={"include_usage": True}  # –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–∫–µ–Ω–∞—Ö

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —á–∞–Ω–∫–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏
if hasattr(chunk, 'usage') and chunk.usage:
    total_tokens_input = chunk.usage.prompt_tokens
    total_tokens_output = chunk.usage.completion_tokens
```

---

### 2. ‚úÖ –£–±—Ä–∞–Ω–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤–æ frontend

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω `setTimeout(20)` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞, —á—Ç–æ –∑–∞–º–µ–¥–ª—è–ª–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ 20–º—Å √ó –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∞ –æ—á–µ—Ä–µ–¥—å —á–∞–Ω–∫–æ–≤ —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- –ß–∞–Ω–∫–∏ —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ –º–µ—Ä–µ –ø–æ–ª—É—á–µ–Ω–∏—è
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ —á–µ—Ä–µ–∑ `scrollIntoView({ behavior: 'smooth' })`

**–§–∞–π–ª—ã:**
- `ai-chat-platform/js/app.js` - —Ñ—É–Ω–∫—Ü–∏—è `sendMessage()`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –û—Ç–∫–ª–∏–∫ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ —Å—Ç–∞–ª –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –æ—Ç–≤–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ 0.5-2 —Å–µ–∫—É–Ω–¥—ã (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–ª–∏–Ω—ã –æ—Ç–≤–µ—Ç–∞)

---

### 3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã —Å—Ç—Ä–∏–º–∏–Ω–≥–∞

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∫–Ω–æ–ø–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (‚èπÔ∏è) –≤–æ –≤—Ä–µ–º—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `AbortController` –¥–ª—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è fetch –∑–∞–ø—Ä–æ—Å–∞
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ

**–§–∞–π–ª—ã:**
- `ai-chat-platform/js/app.js`:
  - –§—É–Ω–∫—Ü–∏—è `sendMessageStreamAPI()` - –¥–æ–±–∞–≤–ª–µ–Ω AbortController
  - –§—É–Ω–∫—Ü–∏—è `cancelCurrentStream()` - –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–º–µ–Ω—ã
  - –§—É–Ω–∫—Ü–∏—è `updateSendButton()` - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏

**–ö–æ–¥:**
```javascript
// –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –æ—Ç–º–µ–Ω—ã
const abortController = new AbortController();
AppState.currentStreamAbortController = abortController;

// –ü–µ—Ä–µ–¥–∞—á–∞ signal –≤ fetch
fetch(url, {
    signal: abortController.signal
    // ...
})

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–º–µ–Ω—ã
function cancelCurrentStream() {
    if (AppState.currentStreamAbortController) {
        AppState.currentStreamAbortController.abort();
        // ...
    }
}
```

---

### 4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç—Ä–∏–º–∏–Ω–≥–∞

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ú–∏–≥–∞—é—â–∏–π –∫—É—Ä—Å–æ—Ä (‚ñã) –≤ –∫–æ–Ω—Ü–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- –ü–ª–∞–≤–Ω–∞—è –ø—É–ª—å—Å–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- –ö–ª–∞—Å—Å `.streaming` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è/—É–¥–∞–ª—è–µ—Ç—Å—è

**–§–∞–π–ª—ã:**
- `ai-chat-platform/css/styles.css` - CSS –∞–Ω–∏–º–∞—Ü–∏–∏
- `ai-chat-platform/js/app.js` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–º streaming

**CSS –∞–Ω–∏–º–∞—Ü–∏–∏:**
```css
/* –ú–∏–≥–∞—é—â–∏–π –∫—É—Ä—Å–æ—Ä */
.message.streaming .message-body::after {
    content: '‚ñã';
    animation: blink 1s infinite;
}

/* –ü—É–ª—å—Å–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è */
.message.streaming {
    animation: pulse 2s ease-in-out infinite;
}
```

---

## üöÄ –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|----|----|-----------|
| –ó–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–∞–Ω–∫–∞ | ~20ms | ~0ms | ‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ |
| –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ–¥—Å—á–µ—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤ | ~75% | 100% | ‚úÖ –¢–æ—á–Ω–æ |
| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | üéØ –î–æ–±–∞–≤–ª–µ–Ω–æ |
| –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å | üîπ –ë–∞–∑–æ–≤–∞—è | üåü –û—Ç–ª–∏—á–Ω–∞—è | ‚≠ê –£–ª—É—á—à–µ–Ω–æ |

---

## üìã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Backend

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å backend:**
   ```bash
   cd ai-chat-backend
   source venv/bin/activate  # –∏–ª–∏ venv\Scripts\activate –Ω–∞ Windows
   uvicorn app.main:app --reload
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å endpoint —Å—Ç—Ä–∏–º–∏–Ω–≥–∞:**
   ```bash
   # –¢–µ—Å—Ç —á–µ—Ä–µ–∑ curl (–∑–∞–º–µ–Ω–∏—Ç–µ TOKEN –∏ CHAT_ID)
   curl -N -H "Authorization: Bearer YOUR_TOKEN" \
        -H "Content-Type: application/json" \
        -d '{"content": "–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ", "model": "openai/gpt-3.5-turbo"}' \
        http://localhost:8000/api/v1/llm/chat/CHAT_ID/message/stream
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤:**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î: `tokens_input` –∏ `tokens_output` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å > 0
   - –°—Ä–∞–≤–Ω–∏—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –ª–æ–≥–∞—Ö backend

### Frontend

1. **–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - –û—Ç–∫—Ä—ã—Ç—å `ai-chat-platform/index.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç–æ–π HTTP —Å–µ—Ä–≤–µ—Ä:
     ```bash
     cd ai-chat-platform
     python -m http.server 8080
     ```

2. **–¢–µ—Å—Ç—ã —Å—Ç—Ä–∏–º–∏–Ω–≥–∞:**
   
   ‚úÖ **–¢–µ—Å—Ç 1: –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–ª–∏–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–æ –æ –∫–≤–∞–Ω—Ç–æ–≤–æ–π —Ñ–∏–∑–∏–∫–µ"
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–µ–∫—Å—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ
   - –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–∏–º—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏

   ‚úÖ **–¢–µ—Å—Ç 2: –í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –º–∏–≥–∞—é—â–µ–≥–æ –∫—É—Ä—Å–æ—Ä–∞ ‚ñã –≤ –∫–æ–Ω—Ü–µ —Ç–µ–∫—Å—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞–≤–Ω—É—é –ø—É–ª—å—Å–∞—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏—è

   ‚úÖ **–¢–µ—Å—Ç 3: –û—Ç–º–µ–Ω–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–ª–∏–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
   - –í–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∏–∫–Ω—É—Ç—å –∫–Ω–æ–ø–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ ‚èπÔ∏è
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
     - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
     - –ü–æ—è–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
     - –ù–µ–ø–æ–ª–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è
     - –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚û§

   ‚úÖ **–¢–µ—Å—Ç 4: –¢–æ—á–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
   - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
     - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
     - –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
     - –ë–∞–ª–∞–Ω—Å —É–º–µ–Ω—å—à–∏–ª—Å—è –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞

   ‚úÖ **–¢–µ—Å—Ç 5: Markdown –∏ –∫–æ–¥**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å: "–ù–∞–ø–∏—à–∏ –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ Python –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –º–∞—Å—Å–∏–≤–∞"
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
     - Markdown —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –≤–æ –≤—Ä–µ–º—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
     - –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∫–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
     - –ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      HTTP POST       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             ‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>  ‚îÇ              ‚îÇ
‚îÇ  Frontend   ‚îÇ                       ‚îÇ   Backend    ‚îÇ
‚îÇ   (React)   ‚îÇ  <SSE Stream (text/  ‚îÇ   (FastAPI)  ‚îÇ
‚îÇ             ‚îÇ     event-stream)     ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                             ‚îÇ
                                             v
                                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                      ‚îÇ  OpenRouter  ‚îÇ
                                      ‚îÇ      API     ‚îÇ
                                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Event Types:
- start:   –ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- content: –ß–∞–Ω–∫ —Ç–µ–∫—Å—Ç–∞
- end:     –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ (+ —Ç–æ–∫–µ–Ω—ã + —Å—Ç–æ–∏–º–æ—Å—Ç—å)
- error:   –û—à–∏–±–∫–∞
```

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```javascript
AppState = {
    isStreaming: false,                    // –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
    currentStreamAbortController: null,    // –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–º–µ–Ω—ã
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

### –§–æ—Ä–º–∞—Ç SSE —Å–æ–±—ã—Ç–∏–π

```
data: {"type": "start", "model": "gpt-4"}
data: {"type": "content", "content": "Hello"}
data: {"type": "content", "content": " world"}
data: {"type": "end", "message_id": "uuid", "tokens": {"input": 10, "output": 20}, "cost": 0.05}
```

---

## üìù –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã:
- –°—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–æ–≤—ã–º backend
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
- API –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **OpenRouter API:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å `stream_options`. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω fallback –Ω–∞ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç.

2. **–ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:** AbortController –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö, –Ω–æ –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ IE11.

3. **Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥:** –ü—Ä–∏ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ–º —Å—Ç—Ä–∏–º–∏–Ω–≥–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ markdown (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–∞ —á–µ—Ä–µ–∑ debounce).

---

## üîú –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∫–æ–Ω–Ω–µ–∫—Ç –ø—Ä–∏ –æ–±—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é —á–∞–Ω–∫–æ–≤ –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—Ç–æ–∫–µ–Ω–æ–≤/—Å–µ–∫)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebSocket –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ SSE

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend: `docker logs <container-id>`
2. –û—Ç–∫—Ä—ã—Ç—å DevTools –±—Ä–∞—É–∑–µ—Ä–∞ ‚Üí Network ‚Üí Filter: EventStream
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏ JavaScript

---

**–ê–≤—Ç–æ—Ä —É–ª—É—á—à–µ–Ω–∏–π:** AI Assistant  
**–î–∞—Ç–∞:** 2 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–í–µ—Ä—Å–∏—è:** 1.0
